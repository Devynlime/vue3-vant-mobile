<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>video</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" href="http://11.188.90.42:31523/videoComponent/v1.0.0/style/common.css">
    <link rel="stylesheet" href="http://11.188.90.42:31523/videoComponent/v1.0.0/style/video.css">
    <script src="http://11.188.90.42:31523/videoComponent/v1.0.0/jquery.min.js"></script>
    <script src="http://11.188.90.42:31523/videoComponent/v1.0.0/script/h265/player.js"></script>
    <script src="http://11.188.90.42:31523/videoComponent/v1.0.0/script/method.js"></script>
    <script src="http://11.188.90.42:31523/videoComponent/v1.0.0/script/flv.min.js"></script>
    <script src="http://11.188.90.42:31523/videoComponent/v1.0.0/script/h265/common.js"></script>
    <script src="http://11.188.90.42:31523/videoComponent/v1.0.0/script/h265/pcm-player.js"></script>
    <script src="http://11.188.90.42:31523/videoComponent/v1.0.0/script/h265/webgl.js"></script>
    <script src="http://11.188.90.42:31523/videoComponent/v1.0.0/uvp-bai.js"></script>
</head>
<style>
    #videoDlg {
        height: 100%;
        margin: 0px;
        padding: 0px;
        overflow: hidden;
    }
</style>

<body style="background-color: #000;overflow: hidden;">
    <div id="videoDlg" style="overflow: hidden;">
        <div id="videoBox" style="margin-left:auto;margin-right: auto;width: fit-content;height:inherit; overflow: hidden;"></div>
        <div style="display:none;">
            <input type="text" value="" id="tokenStr" />
            <input type="text" value="300190000003040168" id="deviceCodeStr" />
            <button onclick="test1()">test1</button><button onclick="test2()">test2</button>
        </div>
    </div>
    <script>
        var videoObj
        var urlinfo = window.location.href;
        console.log(">>>>>url info:", urlinfo)
        var reg = new RegExp("(^|&)token=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        var token = decodeURI(r[2])
        console.log(">>>>>>>>>", decodeURI(r[2]))

        window.onload = function () {
            console.log('页面加载完毕！token:',token);
            window.videoObj = videoObj = new VideoObj("videoBox",
                1,
                "25.83.2.234", "80", token,
                1, "onEventNotify", true, "djz3272")
            videoObj.setDownloadFileType('mp4')
        };

        function onEventNotify(eventType, eventContext) {
            console.log("eventType:", eventType, "eventContext:", eventContext)
        }
        window.destoryVideo = function () {
            videoObj.destory("videoBox")
        }

        window.captureVideo = function (filename) {
            videoObj.capture(1, filename)
        }

        window.realRecordVideo = function (filename) {
            videoObj.realRecord(1, filename)
        }

        window.setWaterMarkVideo = function (title) {
            videoObj.setWaterMark(title, 10, 30, 1, 1)
        }
        window.palyVideo = function (deviceCode, title) {
            console.log("play video......", deviceCode, title)
            videoObj.videoPlay(1, 1, deviceCode, null, title, 1, null)
            videoObj.setVideoSize(1,true)
        }

        window.setVideoSize = function () {
            videoObj.setVideoSize(1)
        }

        function test1() {
            let deviceCode = document.getElementById("deviceCodeStr").value
            videoObj.videoPlay(1, 1, deviceCode, null, "title", 1, null)
        }

        function test2() {
            let token = document.getElementById("tokenStr").value
            window.videoObj = videoObj = new VideoObj("videoBox",
                1,
                "11.188.90.42", "31523", token,
                1, "onEventNotify", true, "djz3272")
            videoObj.setDownloadFileType('mp4')
        }
    </script>
</body>

</html>